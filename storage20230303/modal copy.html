<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="normalize.css" />
    <link rel="stylesheet" href="modal.css" />
  </head>

  <body>
    <div class="article-container">
      <header class="header">
        <h1 class="heading">포트폴리오</h1>
      </header>
      <article class="content">
        <p>마우스가 떠나면 나타나는 팝업</p>
      </article>
    </div>
    <div class="modal-container">
      <article class="modal">
        <h2>모달팝업</h2>
        <p>마우스가 떠나면 나타나는 팝업</p>
        <form action="#" method="post">
          <input id="subscribe-email" type="email" value="" placeholder="Your email" name="member[email]" class="email" />
          <input type="submit" name="member[subscribe]" class="button" value="Subscribe" />
        </form>
        <p><a href="#" class="close" id="close-modal">오늘 하루 창 안보기</a></p>
      </article>
    </div>
    <script src="https://code.jquery.com/jquery-1.12.1.min.js"></script>
    <script>
      //마우스가 윈도우 창 밖으로 벗어나면 세션에 저장된 정보가 있는지 확인.

      $(window).mouseleave(function (e) {
        var modalSeen = sessionStorage.getItem("modalSeen");
        if (e.toElement == null && !modalSeen) {
          document.body.classList.add("mouse-out");
        }
      });

      $("#close-modal").click(function (e) {
        e.preventDefault();
        document.body.classList.remove("mouse-out");
        sessionStorage.setItem("modalSeen", true);
      });

      // 바닐라 자바스크립트로 바꾸기.
      // const main = document.body;
      // main.addEventListener("mouseleave", () => {
      //   var modalSeen = sessionStorage.getItem("modalSeen");
      //   console.log(modalSeen); //새방문자는null
      //   if (e.toElement == null && !modalSeen) {
      //     document.body.classList.add("mouse-out");
      //   }
      // });

      // $("#close-modal").click(function (e) {
      //   e.preventDefault();
      //   document.body.classList.remove("mouse-out");
      //   sessionStorage.setItem("modalSeen", true);
      // });
    </script>
  </body>
</html>
